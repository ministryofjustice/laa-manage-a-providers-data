{% extends 'view-provider.html' %}
{% from 'macros/contact_tables.html' import contactCards %}
{%- from "govuk_frontend_jinja/components/breadcrumbs/macro.html" import govukBreadcrumbs -%}
{% from "govuk_frontend_jinja/components/warning-text/macro.html" import govukWarningText %}

{% block beforeContent %}
  {% if parent_provider %}
    {{ govukBreadcrumbs({
      "items": [
        {
          "text": parent_provider.firm_name,
          "href": url_for("main.view_provider", firm=parent_provider)
        },
        {
          "text": firm.firm_name,
          "href": url_for("main.view_provider", firm=firm)
        }]
    }) }}
  {% else %}
    {# Fallback if no Firm has no associated Chambers #}
    {{ govukBackLink({"text": "Back to all providers", "href": url_for("main.providers") }) }}
  {% endif %}
{% endblock %}

{% block actionButtons %}
  {{ govukButton({
    "text": "Make active" if firm.inactive_date else "Make inactive",
    "classes": "govuk-button--secondary",
    "href": url_for("main.change_provider_active_status", firm=firm)
  }) }}
  {{ govukButton({
    "text": "Hold payments",
    "classes": "govuk-button--secondary govuk-!-margin-left-3",
  }) }}
  {{ govukButton({
    "text": "Record intervention",
    "classes": "govuk-button--secondary govuk-!-margin-left-3",
  }) }}
{% endblock %}

{% block firmTypeSubNavigation %}
	{{ mojSubNavigation({
    "label": "Sub navigation",
    "items": [{
      "text": "Contact",
      "href": url_for("main.view_provider_contact", firm=firm),
      "active": subpage == "contact"
    }, {
      "text": "Bank accounts and payment",
      "href": url_for("main.view_provider_bank_accounts_payment", firm=firm),
      "active": subpage == "bank-accounts-payment"
    }]
  }) }}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      {% if subpage == "contact" %}
        {% if contact_details_table %}
          <h3 class="govuk-heading-m">Contact details</h3>
          {{ govukTable(contact_details_table.to_govuk_params()) }}
        {% endif %}
        {{ contactCards(contact_tables) }}
      {% endif %}
      
      {% if subpage == "bank-accounts-payment" %}
        {% if head_office %}
          <h2 class="govuk-heading-m">Payment information</h2>
          {{ govukSummaryList(payment_information_table.to_summary_govuk_params()) }}

          <h2 class="govuk-heading-m">VAT registration number</h2>
          {{ govukSummaryList(vat_registration_table.to_summary_govuk_params()) }}

          <h2 class="govuk-heading-m">Bank accounts</h2>
          {% if bank_account_table %}
              {{ govukSummaryList(bank_account_table.to_summary_govuk_params()) }}
          {% else %}
              {{ govukButton({
                  "text": "Add bank account",
                  "href": "#"
              }) }}
          {% endif %}
        {% else %}
          {{ govukWarningText({"text": "Bank account information not available. Contact mapd@justice.gov.uk for more information."}) }}
        {% endif %}
      {% endif %}
    </div>
  </div>
{% endblock %}